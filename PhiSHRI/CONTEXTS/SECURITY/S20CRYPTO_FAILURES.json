{
  "door_code": "S20CRYPTO_FAILURES",
  "semantic_path": "SECURITY.VULNERABILITIES.CRYPTOGRAPHIC_FAILURES",
  "aliases": ["cryptographic failures", "weak encryption", "broken crypto", "insecure crypto", "crypto misuse"],
  "context_bundle": {
    "summary": "Cryptographic failures prevention: use strong algorithms (AES-256, RSA-4096, SHA-256+), avoid weak/deprecated crypto (MD5, SHA-1, DES, RC4), use secure random sources, protect keys properly, implement proper key management and rotation.",
    "prerequisites": ["S06ENCRYPTION", "S05SECRETS"],
    "related_doors": ["S13SECRETS_ROTATION", "S14ENCRYPTION", "S07OAUTH"],
    "onboarding": {
      "quick_start": "Crypto best practices: 1) Use industry-standard libraries (OpenSSL, libsodium, Web Crypto API), 2) AES-256-GCM for encryption, 3) PBKDF2/bcrypt/Argon2 for passwords, 4) TLS 1.2+ for transport, 5) Secure random: /dev/urandom or crypto.randomBytes(), 6) Never roll your own crypto.",
      "full_context_path": "/PhiDEX/MASTER_CODEX/06_SECURITY/ENCRYPTION_GUIDE.md",
      "common_patterns": [
        "Symmetric encryption: AES-256-GCM (authenticated encryption with associated data)",
        "Asymmetric encryption: RSA-4096 or ECC (Curve25519)",
        "Hashing: SHA-256 or SHA-3 (avoid MD5, SHA-1)",
        "Password hashing: Argon2id > bcrypt > PBKDF2 (with salt, high iterations)",
        "TLS/SSL: TLS 1.2+ only, disable SSLv3/TLS 1.0/1.1",
        "Random: crypto.randomBytes() (Node), secrets module (Python), SecureRandom (Java)"
      ],
      "known_errors": [
        {
          "error": "Using weak algorithms like MD5 or SHA-1 for hashing",
          "cause": "Legacy code or developer unfamiliarity with crypto weaknesses",
          "solution": "Migrate to SHA-256 minimum, SHA-3 preferred. For passwords use Argon2id/bcrypt.",
          "prevention": "Static analysis tools to detect weak crypto, automated dependency checks",
          "example": "BAD: md5(password). GOOD: argon2.hash(password, {type: argon2.argon2id})"
        },
        {
          "error": "Storing encryption keys in code or config files",
          "cause": "Convenience over security, lack of key management infrastructure",
          "solution": "Use environment variables minimum, secrets manager preferred (Vault, AWS Secrets Manager)",
          "prevention": "Never commit .env files, use .gitignore, scan repos for leaked secrets",
          "related_door": "S05SECRETS"
        },
        {
          "error": "Using ECB mode for block ciphers (produces identical ciphertext for identical plaintext blocks)",
          "cause": "Default mode in some libraries, developer unfamiliarity",
          "solution": "Use GCM or CBC mode with random IV. GCM provides authentication.",
          "prevention": "Code review checklist: reject ECB mode, require authenticated encryption",
          "example": "BAD: AES-256-ECB. GOOD: AES-256-GCM with unique IV per message"
        },
        {
          "error": "Insufficient entropy in random number generation",
          "cause": "Using Math.random() or predictable seeds instead of crypto-secure RNG",
          "solution": "Use cryptographically secure RNG: crypto.randomBytes(), /dev/urandom, SecureRandom",
          "prevention": "Linter rules to detect Math.random() in security contexts"
        }
      ]
    },
    "resources": {
      "docs": [
        "/PhiDEX/MASTER_CODEX/06_SECURITY/ENCRYPTION_GUIDE.md",
        "/PhiDEX/MASTER_CODEX/06_SECURITY/OWASP_TOP_10_GUIDE.md"
      ],
      "code": [],
      "tests": [],
      "errors": []
    },
    "metadata": {
      "last_updated": "2025-11-22T04:00:00Z",
      "confidence": 1.0,
      "usage_count": 0,
      "success_rate": 0.0,
      "tags": ["cryptography", "encryption", "weak_crypto", "owasp", "tls", "aes", "rsa"],
      "category": "SECURITY",
      "subcategory": "VULNERABILITIES",
      "version": "1.0.0",
      "tested_on": ["All platforms"],
      "agent_affinity": ["VSCC", "DC", "WEBC"]
    }
  }
}
